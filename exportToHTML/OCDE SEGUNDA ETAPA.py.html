<html>
<head>
<title>OCDE SEGUNDA ETAPA.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #cfd2d5;}
.s2 { color: #cc7832;}
.s3 { color: #8ea765;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#232425">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
OCDE SEGUNDA ETAPA.py</font>
</center></td></tr></table>
<pre><span class="s0"># =======================================================================================================================</span>
<span class="s0"># =================================================Cálculo de RNK OCDE===================================================</span>
<span class="s0"># =======================================================================================================================</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">import </span><span class="s1">decimal</span>
<span class="s2">from </span><span class="s1">decimal </span><span class="s2">import </span><span class="s1">Decimal </span><span class="s2">as </span><span class="s1">D</span>
<span class="s1">context = decimal.getcontext()</span>
<span class="s1">context.rounding = decimal.ROUND_HALF_UP</span>
<span class="s0"># ===================================================CONSIDERACIONES=====================================================</span>
<span class="s3">&quot;SUBAREAS OCDE&quot;</span>
<span class="s3">&quot;1.01 Matemáticas&quot;</span>
<span class="s3">&quot;1.02 Computación y Ciencias de la informática&quot;</span>
<span class="s3">&quot;1.03 Ciencias Físicas y Astronomía&quot;</span>
<span class="s3">&quot;1.04 Ciencias Químicas&quot;</span>
<span class="s3">&quot;1.05 Ciencias de la Tierra y Medioambientales&quot;</span>
<span class="s3">&quot;1.06 Ciencias Biológicas&quot;</span>
<span class="s3">&quot;1.07 Otras Ciencias Naturales&quot;</span>
<span class="s3">&quot;2.01 Ingeniería Civil&quot;</span>
<span class="s3">&quot;2.02 Ingeniería Eléctrica y Electrónica&quot;</span>
<span class="s3">&quot;2.03 Ingeniería Mecánica&quot;</span>
<span class="s3">&quot;2.04 Ingeniería Química&quot;</span>
<span class="s3">&quot;2.05 Ingeniería de Materiales&quot;</span>
<span class="s3">&quot;2.06 Ingeniería Médica&quot;</span>
<span class="s3">&quot;2.07 Ingeniería Medioambiental&quot;</span>
<span class="s3">&quot;2.08 Biotecnología Medioambiental&quot;</span>
<span class="s3">&quot;2.09 Biotecnología Industrial&quot;</span>
<span class="s3">&quot;2.10 Nanotecnología&quot;</span>
<span class="s3">&quot;2.11 Otras Ingenierías y Tecnologías&quot;</span>
<span class="s3">&quot;3.01 Medicina Básica&quot;</span>
<span class="s3">&quot;3.02 Medicina Clínica&quot;</span>
<span class="s3">&quot;3.03 Ciencias de la Salud&quot;</span>
<span class="s3">&quot;4.01 Agricultura, Silvicultura y Pesca&quot;</span>
<span class="s3">&quot;4.02 Ciencias Animales y de la Leche&quot;</span>
<span class="s3">&quot;4.03 Ciencias Veterinarias&quot;</span>
<span class="s3">&quot;4.05 Otras Ciencias Agrícolas&quot;</span>
<span class="s3">&quot;5.01 Psicología&quot;</span>
<span class="s3">&quot;5.02 Economía y Negocios&quot;</span>
<span class="s3">&quot;5.03 Ciencias de la Educación&quot;</span>
<span class="s3">&quot;5.04 Sociología&quot;</span>
<span class="s3">&quot;5.05 Leyes&quot;</span>
<span class="s3">&quot;5.06 Ciencias Políticas&quot;</span>
<span class="s3">&quot;5.07 Geografía Social y Económica&quot;</span>
<span class="s3">&quot;5.08 Periodismo y Comunicaciones&quot;</span>
<span class="s3">&quot;5.09 Otras Ciencias Sociales&quot;</span>
<span class="s3">&quot;6.01 Historia y Arqueología&quot;</span>
<span class="s3">&quot;6.02 Idiomas y Literatura&quot;</span>
<span class="s3">&quot;6.03 Filosofía, Ética y Religión&quot;</span>
<span class="s3">&quot;6.04 Arte&quot;</span>
<span class="s3">&quot;6.05 Otras Humanidades&quot;</span>

<span class="s0">#Importar el resultado de la Primera Etapa &quot;CONSOLIDADO - TIPO RANKING 2021.csv&quot;</span>
<span class="s0"># Definiciones para nombres dinámicos</span>
<span class="s0">########################################################################################################################</span>
<span class="s1">DEFINICIONES = pd.read_csv(</span><span class="s3">'Definiciones.csv'</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">&quot;;&quot;</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">&quot;UTF-8&quot;</span><span class="s2">, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s0">########################################################################################################################</span>
<span class="s1">Consolidado_AC_NA = pd.read_csv(</span><span class="s3">&quot;PRODUCTOS/AJUSTES/CONSOLIDADO - TIPO RANKING 2021.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">&quot;;&quot;</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">&quot;latin-1&quot;</span><span class="s2">, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s0">########################################################################################################################</span>

<span class="s0">########################################################################################################################</span>
<span class="s0">########################################################################################################################</span>
<span class="s0">########################################################################################################################</span>
<span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">df = Consolidado_AC_NA.loc[Consolidado_AC_NA[</span><span class="s3">&quot;Sub-área&quot;</span><span class="s1">] == DEFINICIONES[</span><span class="s3">&quot;COD SUBAREA&quot;</span><span class="s1">][i]]</span>
    <span class="s1">df.set_index(</span><span class="s3">'Sub-área'</span><span class="s2">, </span><span class="s1">inplace=</span><span class="s2">True</span><span class="s1">)</span>
    <span class="s1">df.reset_index()</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][i] + </span><span class="s3">' = df'</span><span class="s1">.format(i)))</span>
    <span class="s1">print(df.dtypes)</span>
    <span class="s1">print(df)</span>

<span class="s0">################################################## INDICADOR 1 #########################################################</span>

<span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">Calculo_Documentos = []</span>
    <span class="s1">Calculo_Citas = []</span>
    <span class="s1">Multiplicacion = []</span>
    <span class="s1">Indicador = []</span>
    <span class="s1">df = Consolidado_AC_NA.loc[Consolidado_AC_NA[</span><span class="s3">&quot;Sub-área&quot;</span><span class="s1">] == DEFINICIONES[</span><span class="s3">&quot;COD SUBAREA&quot;</span><span class="s1">][i]]</span>
    <span class="s1">df.set_index(</span><span class="s3">'Sub-área'</span><span class="s2">, </span><span class="s1">inplace=</span><span class="s2">True</span><span class="s1">)</span>
    <span class="s1">df.reset_index()</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s2">, </span><span class="s1">row </span><span class="s2">in </span><span class="s1">df.iterrows():</span>
        <span class="s1">Calculo_Documentos = row[</span><span class="s3">&quot;Web of Science Documents&quot;</span><span class="s1">]</span>
        <span class="s1">Calculo_Citas = row[</span><span class="s3">&quot;Category Normalized Citation Impact&quot;</span><span class="s1">]</span>
        <span class="s1">Multiplicacion = D(str(Calculo_Documentos)) * D(str(Calculo_Citas))</span>
        <span class="s1">Indicador.append(Multiplicacion)</span>
    <span class="s1">df[</span><span class="s3">&quot;Indicador&quot;</span><span class="s1">] = Indicador</span>
    <span class="s1">df[</span><span class="s3">&quot;Indicador&quot;</span><span class="s1">] = df[</span><span class="s3">&quot;Indicador&quot;</span><span class="s1">].astype(float)</span>
    <span class="s0"># ordenamiento jerarquico para desempate</span>
    <span class="s1">df = df.sort_values(</span>
        <span class="s1">by=[</span><span class="s3">&quot;Indicador&quot;</span><span class="s2">,</span><span class="s3">&quot;Web of Science Documents&quot;</span><span class="s2">,</span><span class="s3">&quot;Category Normalized Citation Impact&quot;</span><span class="s2">,</span><span class="s3">&quot;Times Cited&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">ascending=[</span><span class="s2">False,False,False,False</span><span class="s1">])</span>
    <span class="s1">df.reset_index()</span>
    <span class="s1">print(df.dtypes)</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][i] + </span><span class="s3">' = df'</span><span class="s1">.format(i)))</span>

<span class="s0">#Ahora incorporando el indicador</span>
<span class="s1">TODOS_1 = [Matematicas</span><span class="s2">, </span><span class="s1">Computacion</span><span class="s2">, </span><span class="s1">Fisica</span><span class="s2">, </span><span class="s1">Quimica</span><span class="s2">, </span><span class="s1">Tierra</span><span class="s2">, </span><span class="s1">Biologicas</span><span class="s2">, </span><span class="s1">Otras_naturales</span><span class="s2">, </span><span class="s1">Civil</span><span class="s2">, </span><span class="s1">Electrica</span><span class="s2">, </span><span class="s1">Mecanica</span><span class="s2">,</span>
        <span class="s1">Ing_Quimica</span><span class="s2">, </span><span class="s1">Ing_Materiales</span><span class="s2">, </span><span class="s1">Ing_Medica</span><span class="s2">, </span><span class="s1">Ing_Medioambiental</span><span class="s2">, </span><span class="s1">Biotec_Medioambiental</span><span class="s2">, </span><span class="s1">Biotec_Industrial</span><span class="s2">,</span>
        <span class="s1">Nanotecnologia</span><span class="s2">, </span><span class="s1">Otras_Ingenierias</span><span class="s2">, </span><span class="s1">Medicina_Basica</span><span class="s2">, </span><span class="s1">Medicina_Clinica</span><span class="s2">, </span><span class="s1">Ciencias_Salud</span><span class="s2">, </span><span class="s1">Agricultura</span><span class="s2">, </span><span class="s1">Ciencias_Animales</span><span class="s2">,</span>
        <span class="s1">Ciencias_Veterinarias</span><span class="s2">, </span><span class="s1">Otras_Agricolas</span><span class="s2">, </span><span class="s1">Psicologia</span><span class="s2">, </span><span class="s1">Economia</span><span class="s2">, </span><span class="s1">Educacion</span><span class="s2">, </span><span class="s1">Sociologia</span><span class="s2">, </span><span class="s1">Leyes</span><span class="s2">, </span><span class="s1">Ciencias_Politicas</span><span class="s2">,</span>
        <span class="s1">Geografia</span><span class="s2">, </span><span class="s1">Periodismo</span><span class="s2">, </span><span class="s1">Otras_Sociales</span><span class="s2">, </span><span class="s1">Historia</span><span class="s2">, </span><span class="s1">Idiomas</span><span class="s2">, </span><span class="s1">Filosofia</span><span class="s2">, </span><span class="s1">Arte</span><span class="s2">, </span><span class="s1">Otras_Humanidades]</span>


<span class="s0"># Antes hay que filtrar por institución académica y no académica</span>
<span class="s0"># -------------------------------------------------FILTROS---------------------------------------------------------------</span>
<span class="s0"># -------------------------------------------FILTRO NO ACADEMICA---------------------------------------------------------</span>

<span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">df = TODOS_1[i]</span>
    <span class="s1">df_NA = df.loc[(df[</span><span class="s3">&quot;Tipo Ranking 2021 (Definitivo)&quot;</span><span class="s1">] == </span><span class="s3">&quot;2 - Ranking no Académico&quot;</span><span class="s1">)]</span>
    <span class="s1">df_NA.reset_index()</span>
    <span class="s1">df_NA_CH = df_NA.loc[(df_NA[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">] == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">)]</span>
    <span class="s2">if </span><span class="s1">len(df_NA_CH) &gt; </span><span class="s4">1</span><span class="s1">:</span>
        <span class="s1">df_NA = df_NA.loc[~(df_NA[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">] == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">)]</span>
        <span class="s1">df_NA = pd.concat([df_NA</span><span class="s2">, </span><span class="s1">df_NA_CH])</span>
        <span class="s1">df_NA = df_NA.iloc[:-len(df_NA_CH) + </span><span class="s4">1</span><span class="s1">]</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">df_NA = df_NA</span>
    <span class="s1">df_NA = df_NA.sort_values(by=[</span><span class="s3">&quot;Indicador&quot;</span><span class="s2">,</span><span class="s3">&quot;Web of Science Documents&quot;</span><span class="s2">,</span><span class="s3">&quot;Category Normalized Citation Impact&quot;</span><span class="s2">,</span><span class="s3">&quot;Times Cited&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">ascending=[</span><span class="s2">False,False,False,False</span><span class="s1">])</span>
    <span class="s1">df_NA.reset_index()</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][i] + </span><span class="s3">'_NA = df_NA'</span><span class="s1">.format(i)))</span>

<span class="s0"># ------------------------------------------------FILTRO ACADEMICA-------------------------------------------------------</span>
<span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">df = TODOS_1[i]</span>
    <span class="s1">df_AC = df.loc[(df[</span><span class="s3">&quot;Tipo Ranking 2021 (Definitivo)&quot;</span><span class="s1">] == </span><span class="s3">&quot;1 - Ranking Académico&quot;</span><span class="s1">)]</span>
    <span class="s1">df_AC.reset_index()</span>
    <span class="s1">df_AC_CH = df_AC.loc[(df_AC[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">] == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">)]</span>
    <span class="s2">if </span><span class="s1">len(df_AC_CH) &gt; </span><span class="s4">1</span><span class="s1">:</span>
        <span class="s1">df_AC = df_AC.loc[~(df_AC[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">] == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">)]</span>
        <span class="s1">df_AC = pd.concat([df_AC</span><span class="s2">, </span><span class="s1">df_AC_CH])</span>
        <span class="s1">df_AC = df_AC.iloc[:-len(df_AC_CH) + </span><span class="s4">1</span><span class="s1">]</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">df_AC = df_AC</span>
    <span class="s1">df_AC = df_AC.sort_values(by=[</span><span class="s3">&quot;Indicador&quot;</span><span class="s2">,</span><span class="s3">&quot;Web of Science Documents&quot;</span><span class="s2">,</span><span class="s3">&quot;Category Normalized Citation Impact&quot;</span><span class="s2">,</span><span class="s3">&quot;Times Cited&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">ascending=[</span><span class="s2">False,False,False,False</span><span class="s1">])</span>
    <span class="s1">df_AC.reset_index()</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][i] + </span><span class="s3">'_AC = df_AC'</span><span class="s1">.format(i)))</span>

<span class="s0"># ------------------------------------------------ORDENAMIENTO ANID------------------------------------------------------</span>
<span class="s0">#Filtradas y ordenadas jerarquicamente (en esta caso sin las chilenas)</span>
<span class="s1">TODOS_NA = [Matematicas_NA</span><span class="s2">, </span><span class="s1">Computacion_NA</span><span class="s2">, </span><span class="s1">Fisica_NA</span><span class="s2">, </span><span class="s1">Quimica_NA</span><span class="s2">, </span><span class="s1">Tierra_NA</span><span class="s2">, </span><span class="s1">Biologicas_NA</span><span class="s2">, </span><span class="s1">Otras_naturales_NA</span><span class="s2">, </span><span class="s1">Civil_NA</span><span class="s2">,</span>
            <span class="s1">Electrica_NA</span><span class="s2">, </span><span class="s1">Mecanica_NA</span><span class="s2">, </span><span class="s1">Ing_Quimica_NA</span><span class="s2">, </span><span class="s1">Ing_Materiales_NA</span><span class="s2">, </span><span class="s1">Ing_Medica_NA</span><span class="s2">, </span><span class="s1">Ing_Medioambiental_NA</span><span class="s2">,</span>
            <span class="s1">Biotec_Medioambiental_NA</span><span class="s2">, </span><span class="s1">Biotec_Industrial_NA</span><span class="s2">, </span><span class="s1">Nanotecnologia_NA</span><span class="s2">, </span><span class="s1">Otras_Ingenierias_NA</span><span class="s2">, </span><span class="s1">Medicina_Basica_NA</span><span class="s2">,</span>
            <span class="s1">Medicina_Clinica_NA</span><span class="s2">, </span><span class="s1">Ciencias_Salud_NA</span><span class="s2">, </span><span class="s1">Agricultura_NA</span><span class="s2">, </span><span class="s1">Ciencias_Animales_NA</span><span class="s2">, </span><span class="s1">Ciencias_Veterinarias_NA</span><span class="s2">,</span>
            <span class="s1">Otras_Agricolas_NA</span><span class="s2">, </span><span class="s1">Psicologia_NA</span><span class="s2">, </span><span class="s1">Economia_NA</span><span class="s2">, </span><span class="s1">Educacion_NA</span><span class="s2">, </span><span class="s1">Sociologia_NA</span><span class="s2">, </span><span class="s1">Leyes_NA</span><span class="s2">, </span><span class="s1">Ciencias_Politicas_NA</span><span class="s2">,</span>
            <span class="s1">Geografia_NA</span><span class="s2">, </span><span class="s1">Periodismo_NA</span><span class="s2">, </span><span class="s1">Otras_Sociales_NA</span><span class="s2">, </span><span class="s1">Historia_NA</span><span class="s2">, </span><span class="s1">Idiomas_NA</span><span class="s2">, </span><span class="s1">Filosofia_NA</span><span class="s2">, </span><span class="s1">Arte_NA</span><span class="s2">, </span><span class="s1">Otras_Humanidades_NA]</span>
<span class="s0"># ORDENAMIENTO NO ACADEMICA-----------------------------------------------------------------------------------------------------------</span>

<span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">df_ORD_NA = TODOS_NA[x] </span><span class="s0">#Utiliza la lista para llamar a los DF</span>
    <span class="s1">Orden = []</span>
    <span class="s1">Ordenamiento = []</span>
    <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">len(df_ORD_NA) + </span><span class="s4">1</span><span class="s1">):</span>
        <span class="s1">Orden = i</span>
        <span class="s1">Ordenamiento.append(Orden)</span>
    <span class="s1">df_ORD_NA[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] = Ordenamiento</span>
    <span class="s1">df_ORD_NA[</span><span class="s3">&quot;Rank&quot;</span><span class="s1">] = df_ORD_NA[</span><span class="s3">&quot;Indicador&quot;</span><span class="s1">].rank(method=</span><span class="s3">&quot;dense&quot;</span><span class="s2">,</span><span class="s1">ascending=</span><span class="s2">False</span><span class="s1">)</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][x] + </span><span class="s3">'_NA = df_ORD_NA'</span><span class="s1">.format(x)))</span>

<span class="s0"># ------------------------------------------------ORDENAMIENTO ANID------------------------------------------------------</span>
<span class="s0">#Filtradas y ordenadas jerarquicamente (solo con una chilena en ranking)</span>
<span class="s1">TODOS_AC = [Matematicas_AC</span><span class="s2">, </span><span class="s1">Computacion_AC</span><span class="s2">, </span><span class="s1">Fisica_AC</span><span class="s2">, </span><span class="s1">Quimica_AC</span><span class="s2">, </span><span class="s1">Tierra_AC</span><span class="s2">, </span><span class="s1">Biologicas_AC</span><span class="s2">, </span><span class="s1">Otras_naturales_AC</span><span class="s2">,</span>
        <span class="s1">Civil_AC</span><span class="s2">, </span><span class="s1">Electrica_AC</span><span class="s2">, </span><span class="s1">Mecanica_AC</span><span class="s2">, </span><span class="s1">Ing_Quimica_AC</span><span class="s2">, </span><span class="s1">Ing_Materiales_AC</span><span class="s2">, </span><span class="s1">Ing_Medica_AC</span><span class="s2">, </span><span class="s1">Ing_Medioambiental_AC</span><span class="s2">,</span>
        <span class="s1">Biotec_Medioambiental_AC</span><span class="s2">, </span><span class="s1">Biotec_Industrial_AC</span><span class="s2">, </span><span class="s1">Nanotecnologia_AC</span><span class="s2">, </span><span class="s1">Otras_Ingenierias_AC</span><span class="s2">, </span><span class="s1">Medicina_Basica_AC</span><span class="s2">,</span>
        <span class="s1">Medicina_Clinica_AC</span><span class="s2">, </span><span class="s1">Ciencias_Salud_AC</span><span class="s2">, </span><span class="s1">Agricultura_AC</span><span class="s2">, </span><span class="s1">Ciencias_Animales_AC</span><span class="s2">, </span><span class="s1">Ciencias_Veterinarias_AC</span><span class="s2">,</span>
        <span class="s1">Otras_Agricolas_AC</span><span class="s2">, </span><span class="s1">Psicologia_AC</span><span class="s2">, </span><span class="s1">Economia_AC</span><span class="s2">, </span><span class="s1">Educacion_AC</span><span class="s2">, </span><span class="s1">Sociologia_AC</span><span class="s2">, </span><span class="s1">Leyes_AC</span><span class="s2">, </span><span class="s1">Ciencias_Politicas_AC</span><span class="s2">,</span>
        <span class="s1">Geografia_AC</span><span class="s2">, </span><span class="s1">Periodismo_AC</span><span class="s2">, </span><span class="s1">Otras_Sociales_AC</span><span class="s2">, </span><span class="s1">Historia_AC</span><span class="s2">, </span><span class="s1">Idiomas_AC</span><span class="s2">, </span><span class="s1">Filosofia_AC</span><span class="s2">, </span><span class="s1">Arte_AC</span><span class="s2">, </span><span class="s1">Otras_Humanidades_AC]</span>
<span class="s0"># ORDENAMIENTO ACADEMICA -------------------------------------------------------------------------------------------------------------</span>

<span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">df_ORD_AC = TODOS_AC[x] </span><span class="s0">#Utiliza la lista para llamar a los DF</span>
    <span class="s1">Orden = []</span>
    <span class="s1">Ordenamiento = []</span>
    <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">len(df_ORD_AC) + </span><span class="s4">1</span><span class="s1">):</span>
        <span class="s1">Orden = i</span>
        <span class="s1">Ordenamiento.append(Orden)</span>
    <span class="s1">df_ORD_AC[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] = Ordenamiento</span>
    <span class="s1">df_ORD_AC[</span><span class="s3">&quot;Rank&quot;</span><span class="s1">] = df_ORD_AC[</span><span class="s3">&quot;Indicador&quot;</span><span class="s1">].rank(method=</span><span class="s3">&quot;dense&quot;</span><span class="s2">,</span><span class="s1">ascending=</span><span class="s2">False</span><span class="s1">)</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][x] + </span><span class="s3">'_AC = df_ORD_AC'</span><span class="s1">.format(x)))</span>

<span class="s0"># ----------------------------------------------------PUNTAJE------------------------------------------------------------</span>
<span class="s0"># NO ACADEMICA-----------------------------------------------------------------------------------------------------------</span>

<span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">DF_ORD_NA = TODOS_NA[i] </span><span class="s0">#Utiliza la lista para llamar a los DF</span>
    <span class="s1">Primera_Chilena_NA = (DF_ORD_NA[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">].values == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">).argmax() + </span><span class="s4">1</span>
    <span class="s1">Puntaje = []</span>
    <span class="s1">Puntaje_ANID = []</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s2">, </span><span class="s1">row </span><span class="s2">in </span><span class="s1">DF_ORD_NA.iterrows():</span>
        <span class="s2">if </span><span class="s1">row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] &lt;= </span><span class="s4">50</span><span class="s1">:</span>
            <span class="s1">Puntaje = D(</span><span class="s3">&quot;5.000&quot;</span><span class="s1">)</span>
        <span class="s2">elif </span><span class="s1">Primera_Chilena_NA == </span><span class="s4">1</span><span class="s1">:</span>
            <span class="s1">Puntaje = round(D(str(</span><span class="s4">5 </span><span class="s1">- (row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] - </span><span class="s4">50</span><span class="s1">) * </span><span class="s4">4 </span><span class="s1">/ (len(DF_ORD_NA) - </span><span class="s4">50</span><span class="s1">)))</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span>
        <span class="s2">elif </span><span class="s1">(row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] &gt; </span><span class="s4">50</span><span class="s1">) </span><span class="s2">and </span><span class="s1">(row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] &lt; Primera_Chilena_NA):</span>
            <span class="s1">Puntaje = round(D(str(</span><span class="s4">5 </span><span class="s1">- (row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] - </span><span class="s4">50</span><span class="s1">) * </span><span class="s4">4 </span><span class="s1">/ (Primera_Chilena_NA - </span><span class="s4">50</span><span class="s1">)))</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">Puntaje = D(</span><span class="s3">&quot;1.000&quot;</span><span class="s1">)</span>
        <span class="s1">Puntaje_ANID.append(Puntaje)</span>
    <span class="s1">DF_ORD_NA[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">] = Puntaje_ANID</span>
    <span class="s1">DF_ORD_NA[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">] = DF_ORD_NA[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">].astype(float)</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][i] + </span><span class="s3">'_NA = DF_ORD_NA'</span><span class="s1">.format(i)))</span>
    <span class="s1">DF_ORD_NA.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/NO ACADEMICOS/&quot; </span><span class="s1">+ str(DEFINICIONES[</span><span class="s3">&quot;SUBAREA OCDE&quot;</span><span class="s1">][i]) + </span><span class="s3">' - NA.csv'</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">,</span>
              <span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s0"># ACADEMICA--------------------------------------------------------------------------------------------------------------</span>
<span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">39</span><span class="s1">):</span>
    <span class="s1">DF_ORD_AC = TODOS_AC[i] </span><span class="s0">#Utiliza la lista para llamar a los DF</span>
    <span class="s1">Primera_Chilena_AC = (DF_ORD_AC[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">].values == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">).argmax() + </span><span class="s4">1</span>
    <span class="s1">Puntaje = []</span>
    <span class="s1">Puntaje_ANID = []</span>
    <span class="s2">for </span><span class="s1">index</span><span class="s2">, </span><span class="s1">row </span><span class="s2">in </span><span class="s1">DF_ORD_AC.iterrows():</span>
        <span class="s2">if </span><span class="s1">row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] &lt;= </span><span class="s4">100</span><span class="s1">:</span>
            <span class="s1">Puntaje = D(</span><span class="s3">&quot;5.000&quot;</span><span class="s1">)</span>
        <span class="s2">elif </span><span class="s1">Primera_Chilena_AC == </span><span class="s4">1</span><span class="s1">:</span>
            <span class="s1">Puntaje = round(D(str(</span><span class="s4">5 </span><span class="s1">- (row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] - </span><span class="s4">100</span><span class="s1">) * </span><span class="s4">4 </span><span class="s1">/ (len(DF_ORD_AC) - </span><span class="s4">100</span><span class="s1">)))</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span>
        <span class="s2">elif </span><span class="s1">(row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] &gt; </span><span class="s4">100</span><span class="s1">) </span><span class="s2">and </span><span class="s1">(row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] &lt; Primera_Chilena_AC):</span>
            <span class="s1">Puntaje = round(D(str(</span><span class="s4">5 </span><span class="s1">- (row[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] - </span><span class="s4">100</span><span class="s1">) * </span><span class="s4">4 </span><span class="s1">/ (Primera_Chilena_AC - </span><span class="s4">100</span><span class="s1">)))</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">Puntaje = D(</span><span class="s3">&quot;1.000&quot;</span><span class="s1">)</span>
        <span class="s1">Puntaje_ANID.append(Puntaje)</span>
    <span class="s1">DF_ORD_AC[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">] = Puntaje_ANID</span>
    <span class="s1">DF_ORD_AC[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">] = DF_ORD_AC[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">].astype(float)</span>
    <span class="s1">exec(str(DEFINICIONES[</span><span class="s3">&quot;DF&quot;</span><span class="s1">][i] + </span><span class="s3">'_AC = DF_ORD_AC'</span><span class="s1">.format(i)))</span>
    <span class="s1">DF_ORD_AC.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/ACADEMICOS/&quot; </span><span class="s1">+ str(DEFINICIONES[</span><span class="s3">&quot;SUBAREA OCDE&quot;</span><span class="s1">][i]) + </span><span class="s3">' - AC.csv'</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">,</span>
                  <span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>

<span class="s0"># =======================================================================================================================</span>
<span class="s0"># ================================================TODOS NO ACADÉMICOS====================================================</span>
<span class="s0"># =======================================================================================================================</span>
<span class="s0"># Actualiza la lista para concatenarla. Aquí sí se necesitan los DF</span>
<span class="s1">TODOS_NA_1 = [Matematicas_NA</span><span class="s2">, </span><span class="s1">Computacion_NA</span><span class="s2">, </span><span class="s1">Fisica_NA</span><span class="s2">, </span><span class="s1">Quimica_NA</span><span class="s2">, </span><span class="s1">Tierra_NA</span><span class="s2">, </span><span class="s1">Biologicas_NA</span><span class="s2">, </span><span class="s1">Otras_naturales_NA</span><span class="s2">, </span><span class="s1">Civil_NA</span><span class="s2">,</span>
            <span class="s1">Electrica_NA</span><span class="s2">, </span><span class="s1">Mecanica_NA</span><span class="s2">, </span><span class="s1">Ing_Quimica_NA</span><span class="s2">, </span><span class="s1">Ing_Materiales_NA</span><span class="s2">, </span><span class="s1">Ing_Medica_NA</span><span class="s2">, </span><span class="s1">Ing_Medioambiental_NA</span><span class="s2">,</span>
            <span class="s1">Biotec_Medioambiental_NA</span><span class="s2">, </span><span class="s1">Biotec_Industrial_NA</span><span class="s2">, </span><span class="s1">Nanotecnologia_NA</span><span class="s2">, </span><span class="s1">Otras_Ingenierias_NA</span><span class="s2">, </span><span class="s1">Medicina_Basica_NA</span><span class="s2">,</span>
            <span class="s1">Medicina_Clinica_NA</span><span class="s2">, </span><span class="s1">Ciencias_Salud_NA</span><span class="s2">, </span><span class="s1">Agricultura_NA</span><span class="s2">, </span><span class="s1">Ciencias_Animales_NA</span><span class="s2">, </span><span class="s1">Ciencias_Veterinarias_NA</span><span class="s2">,</span>
            <span class="s1">Otras_Agricolas_NA</span><span class="s2">, </span><span class="s1">Psicologia_NA</span><span class="s2">, </span><span class="s1">Economia_NA</span><span class="s2">, </span><span class="s1">Educacion_NA</span><span class="s2">, </span><span class="s1">Sociologia_NA</span><span class="s2">, </span><span class="s1">Leyes_NA</span><span class="s2">, </span><span class="s1">Ciencias_Politicas_NA</span><span class="s2">,</span>
            <span class="s1">Geografia_NA</span><span class="s2">, </span><span class="s1">Periodismo_NA</span><span class="s2">, </span><span class="s1">Otras_Sociales_NA</span><span class="s2">, </span><span class="s1">Historia_NA</span><span class="s2">, </span><span class="s1">Idiomas_NA</span><span class="s2">, </span><span class="s1">Filosofia_NA</span><span class="s2">, </span><span class="s1">Arte_NA</span><span class="s2">, </span><span class="s1">Otras_Humanidades_NA]</span>

<span class="s1">Cuenta_NA = [len(Matematicas_NA)</span><span class="s2">, </span><span class="s1">len(Computacion_NA)</span><span class="s2">, </span><span class="s1">len(Fisica_NA)</span><span class="s2">, </span><span class="s1">len(Quimica_NA)</span><span class="s2">, </span><span class="s1">len(Tierra_NA)</span><span class="s2">, </span><span class="s1">len(Biologicas_NA)</span><span class="s2">,</span>
             <span class="s1">len(Otras_naturales_NA)</span><span class="s2">, </span><span class="s1">len(Civil_NA)</span><span class="s2">, </span><span class="s1">len(Electrica_NA)</span><span class="s2">, </span><span class="s1">len(Mecanica_NA)</span><span class="s2">, </span><span class="s1">len(Ing_Quimica_NA)</span><span class="s2">,</span>
             <span class="s1">len(Ing_Materiales_NA)</span><span class="s2">, </span><span class="s1">len(Ing_Medica_NA)</span><span class="s2">, </span><span class="s1">len(Ing_Medioambiental_NA)</span><span class="s2">, </span><span class="s1">len(Biotec_Medioambiental_NA)</span><span class="s2">,</span>
             <span class="s1">len(Biotec_Industrial_NA)</span><span class="s2">, </span><span class="s1">len(Nanotecnologia_NA)</span><span class="s2">, </span><span class="s1">len(Otras_Ingenierias_NA)</span><span class="s2">, </span><span class="s1">len(Medicina_Basica_NA)</span><span class="s2">,</span>
             <span class="s1">len(Medicina_Clinica_NA)</span><span class="s2">, </span><span class="s1">len(Ciencias_Salud_NA)</span><span class="s2">, </span><span class="s1">len(Agricultura_NA)</span><span class="s2">, </span><span class="s1">len(Ciencias_Animales_NA)</span><span class="s2">,</span>
             <span class="s1">len(Ciencias_Veterinarias_NA)</span><span class="s2">, </span><span class="s1">len(Otras_Agricolas_NA)</span><span class="s2">, </span><span class="s1">len(Psicologia_NA)</span><span class="s2">, </span><span class="s1">len(Economia_NA)</span><span class="s2">,</span>
             <span class="s1">len(Educacion_NA)</span><span class="s2">, </span><span class="s1">len(Sociologia_NA)</span><span class="s2">, </span><span class="s1">len(Leyes_NA)</span><span class="s2">, </span><span class="s1">len(Ciencias_Politicas_NA)</span><span class="s2">, </span><span class="s1">len(Geografia_NA)</span><span class="s2">,</span>
             <span class="s1">len(Periodismo_NA)</span><span class="s2">, </span><span class="s1">len(Otras_Sociales_NA)</span><span class="s2">, </span><span class="s1">len(Historia_NA)</span><span class="s2">,</span><span class="s1">len(Idiomas_NA)</span><span class="s2">, </span><span class="s1">len(Filosofia_NA)</span><span class="s2">,</span>
             <span class="s1">len(Arte_NA)</span><span class="s2">, </span><span class="s1">len(Otras_Humanidades_NA)]</span>

<span class="s1">print(TODOS_NA_1)</span>

<span class="s0"># =================================================EXPORTAR A CSV========================================================</span>
<span class="s0"># Ahora los está concatenando, por lo que esta llamando al dataframe</span>
<span class="s1">CONSOLIDADO_NA = pd.concat(TODOS_NA_1)</span>
<span class="s1">CONSOLIDADO_NA[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">] = CONSOLIDADO_NA[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">].astype(float)</span>
<span class="s1">CONSOLIDADO_NA.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/CONSOLIDADOS/CONSOLIDADO_NA.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>

<span class="s0"># -----------------------------------------------------------------------------------------------------------------------</span>
<span class="s1">PRIMERAS_INSTITUCIONES_CL_NA = CONSOLIDADO_NA.loc[CONSOLIDADO_NA[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">] == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">]</span>
<span class="s1">PRIMERAS_INSTITUCIONES_CL_NA = PRIMERAS_INSTITUCIONES_CL_NA.assign(Cantidad_de_Instituciones=Cuenta_NA)</span>
<span class="s1">n150_NA = CONSOLIDADO_NA.loc[CONSOLIDADO_NA[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] == </span><span class="s4">150</span><span class="s1">]</span>
<span class="s1">n150_NA.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/CONSOLIDADOS/listado_150_NA.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s1">PRIMERAS_INSTITUCIONES_CL_NA.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/CONSOLIDADOS/PRIMERAS_CHILENAS_NA.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s0"># =======================================================================================================================</span>
<span class="s0"># ===================================================TODOS ACADÉMICOS====================================================</span>
<span class="s0"># =======================================================================================================================</span>
<span class="s0"># Actualiza la lista para concatenarla. Aquí sí se necesitan los DF</span>
<span class="s1">TODOS_AC_1 = [Matematicas_AC</span><span class="s2">, </span><span class="s1">Computacion_AC</span><span class="s2">, </span><span class="s1">Fisica_AC</span><span class="s2">, </span><span class="s1">Quimica_AC</span><span class="s2">, </span><span class="s1">Tierra_AC</span><span class="s2">, </span><span class="s1">Biologicas_AC</span><span class="s2">, </span><span class="s1">Otras_naturales_AC</span><span class="s2">,</span>
        <span class="s1">Civil_AC</span><span class="s2">, </span><span class="s1">Electrica_AC</span><span class="s2">, </span><span class="s1">Mecanica_AC</span><span class="s2">, </span><span class="s1">Ing_Quimica_AC</span><span class="s2">, </span><span class="s1">Ing_Materiales_AC</span><span class="s2">, </span><span class="s1">Ing_Medica_AC</span><span class="s2">, </span><span class="s1">Ing_Medioambiental_AC</span><span class="s2">,</span>
        <span class="s1">Biotec_Medioambiental_AC</span><span class="s2">, </span><span class="s1">Biotec_Industrial_AC</span><span class="s2">, </span><span class="s1">Nanotecnologia_AC</span><span class="s2">, </span><span class="s1">Otras_Ingenierias_AC</span><span class="s2">, </span><span class="s1">Medicina_Basica_AC</span><span class="s2">,</span>
        <span class="s1">Medicina_Clinica_AC</span><span class="s2">, </span><span class="s1">Ciencias_Salud_AC</span><span class="s2">, </span><span class="s1">Agricultura_AC</span><span class="s2">, </span><span class="s1">Ciencias_Animales_AC</span><span class="s2">, </span><span class="s1">Ciencias_Veterinarias_AC</span><span class="s2">,</span>
        <span class="s1">Otras_Agricolas_AC</span><span class="s2">, </span><span class="s1">Psicologia_AC</span><span class="s2">, </span><span class="s1">Economia_AC</span><span class="s2">, </span><span class="s1">Educacion_AC</span><span class="s2">, </span><span class="s1">Sociologia_AC</span><span class="s2">, </span><span class="s1">Leyes_AC</span><span class="s2">, </span><span class="s1">Ciencias_Politicas_AC</span><span class="s2">,</span>
        <span class="s1">Geografia_AC</span><span class="s2">, </span><span class="s1">Periodismo_AC</span><span class="s2">, </span><span class="s1">Otras_Sociales_AC</span><span class="s2">, </span><span class="s1">Historia_AC</span><span class="s2">, </span><span class="s1">Idiomas_AC</span><span class="s2">, </span><span class="s1">Filosofia_AC</span><span class="s2">, </span><span class="s1">Arte_AC</span><span class="s2">, </span><span class="s1">Otras_Humanidades_AC]</span>

<span class="s1">Cuenta_AC = [len(Matematicas_AC)</span><span class="s2">, </span><span class="s1">len(Computacion_AC)</span><span class="s2">, </span><span class="s1">len(Fisica_AC)</span><span class="s2">, </span><span class="s1">len(Quimica_AC)</span><span class="s2">, </span><span class="s1">len(Tierra_AC)</span><span class="s2">, </span><span class="s1">len(Biologicas_AC)</span><span class="s2">,</span>
             <span class="s1">len(Otras_naturales_AC)</span><span class="s2">, </span><span class="s1">len(Civil_AC)</span><span class="s2">, </span><span class="s1">len(Electrica_AC)</span><span class="s2">, </span><span class="s1">len(Mecanica_AC)</span><span class="s2">, </span><span class="s1">len(Ing_Quimica_AC)</span><span class="s2">, </span><span class="s1">len(Ing_Materiales_AC)</span><span class="s2">,</span>
             <span class="s1">len(Ing_Medica_AC)</span><span class="s2">, </span><span class="s1">len(Ing_Medioambiental_AC)</span><span class="s2">, </span><span class="s1">len(Biotec_Medioambiental_AC)</span><span class="s2">, </span><span class="s1">len(Biotec_Industrial_AC)</span><span class="s2">,</span>
             <span class="s1">len(Nanotecnologia_AC)</span><span class="s2">, </span><span class="s1">len(Otras_Ingenierias_AC)</span><span class="s2">, </span><span class="s1">len(Medicina_Basica_AC)</span><span class="s2">, </span><span class="s1">len(Medicina_Clinica_AC)</span><span class="s2">,</span>
             <span class="s1">len(Ciencias_Salud_AC)</span><span class="s2">, </span><span class="s1">len(Agricultura_AC)</span><span class="s2">, </span><span class="s1">len(Ciencias_Animales_AC)</span><span class="s2">, </span><span class="s1">len(Ciencias_Veterinarias_AC)</span><span class="s2">,</span>
             <span class="s1">len(Otras_Agricolas_AC)</span><span class="s2">, </span><span class="s1">len(Psicologia_AC)</span><span class="s2">, </span><span class="s1">len(Economia_AC)</span><span class="s2">, </span><span class="s1">len(Educacion_AC)</span><span class="s2">, </span><span class="s1">len(Sociologia_AC)</span><span class="s2">,</span>
             <span class="s1">len(Leyes_AC)</span><span class="s2">, </span><span class="s1">len(Ciencias_Politicas_AC)</span><span class="s2">, </span><span class="s1">len(Geografia_AC)</span><span class="s2">, </span><span class="s1">len(Periodismo_AC)</span><span class="s2">, </span><span class="s1">len(Otras_Sociales_AC)</span><span class="s2">,</span>
             <span class="s1">len(Historia_AC)</span><span class="s2">, </span><span class="s1">len(Idiomas_AC)</span><span class="s2">, </span><span class="s1">len(Filosofia_AC)</span><span class="s2">, </span><span class="s1">len(Arte_AC)</span><span class="s2">, </span><span class="s1">len(Otras_Humanidades_AC)]</span>

<span class="s1">print(Cuenta_AC)</span>

<span class="s0"># =================================================EXPORTAR A CSV========================================================</span>

<span class="s1">CONSOLIDADO_AC = pd.concat(TODOS_AC_1)</span>
<span class="s1">CONSOLIDADO_AC[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">] = CONSOLIDADO_AC[</span><span class="s3">&quot;Puntaje_ANID&quot;</span><span class="s1">].astype(float)</span>
<span class="s1">CONSOLIDADO_AC.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/CONSOLIDADOS/CONSOLIDADO_AC.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>

<span class="s0"># ----------------------------------------------------------------------------------------------------------------------</span>
<span class="s1">PRIMERAS_INSTITUCIONES_CL_AC = CONSOLIDADO_AC.loc[CONSOLIDADO_AC[</span><span class="s3">&quot;Country or Region&quot;</span><span class="s1">] == </span><span class="s3">&quot;CHILE&quot;</span><span class="s1">]</span>
<span class="s1">PRIMERAS_INSTITUCIONES_CL_AC = PRIMERAS_INSTITUCIONES_CL_AC.assign(Cantidad_de_Instituciones=Cuenta_AC)</span>
<span class="s1">n150_AC = CONSOLIDADO_AC.loc[CONSOLIDADO_AC[</span><span class="s3">&quot;Ranking_ANID&quot;</span><span class="s1">] == </span><span class="s4">150</span><span class="s1">]</span>
<span class="s1">n150_AC.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/CONSOLIDADOS/listado_150_AC.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s1">PRIMERAS_INSTITUCIONES_CL_AC.to_csv(</span><span class="s3">&quot;PRODUCTOS/RANKINGS/CONSOLIDADOS/PRIMERAS_CHILENAS_AC.csv&quot;</span><span class="s2">, </span><span class="s1">sep=</span><span class="s3">';'</span><span class="s2">, </span><span class="s1">encoding=</span><span class="s3">'latin-1'</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">True, </span><span class="s1">decimal=</span><span class="s3">','</span><span class="s1">)</span>
<span class="s0"># =====================================================FIN===============================================================</span>

<span class="s1">print(</span><span class="s3">&quot;Proceso Finalizado&quot;</span><span class="s1">)</span>
</pre>
</body>
</html>